### Proof Of Concept
Title   : Es Coco Primer
Type    : Medium->Hard - Cryptography
By @WanZKey

## Summary :
Pada tantangan ini peserta diberikan sebuah file output dari enkripsi "two modular coprime", singkatnya ini merupakan enkripsi "Euclidean Algoritm".


## Overview :
Peserta diberikan 2 file, yakni chall.py dan output.txt, chall.py merupakan file mekanisme enrkipsi yang digunakan
dalam tantangan cryptography ini, sedangkan output.txt merupakan keluaran/output flag yang telah dienkripsi tersebut (ciphertext).


## Solution :
#1. Verify Coprimality of a and b
Confirm that gcd(32061, 25772) = 1 using the Euclidean Algorithm.
Output: Confirmed coprime.

#2. Apply Extended Euclidean Algorithm
Find integers x and y such that:
32061x + 25772y = 1

#Manual Calculation Steps:
32061 = 1*25772 + 6289  
25772 = 4*6289 + 616  
6289 = 10*616 + 129  
616 = 4*129 + 100  
129 = 1*100 + 29  
100 = 3*29 + 13  
29 = 2*13 + 3  
13 = 4*3 + 1  

#Backward Substitution:
1 = 13 - 4*3  
  = 13 - 4*(29 - 2*13)  
  = 9*13 - 4*29  
  = 9*(100 - 3*29) - 4*29  
  = 9*100 - 31*29  
  = 9*100 - 31*(129 - 1*100)  
  = 40*100 - 31*129  
  = 40*(616 - 4*129) - 31*129  
  = 40*616 - 191*129  
  = 40*616 - 191*(6289 - 10*616)  
  = 1950*616 - 191*6289  
  = 1950*(25772 - 4*6289) - 191*6289  
  = 1950*25772 - 7991*6289  
  = 1950*25772 - 7991*(32061 - 1*25772)  
  = 9941*25772 - 7991*32061  

#Hasil:
x = -7991  
y = 9941  

##3. Rumus Dekripsi Flag:
1. Untuk Mendekripsi flagnya menggunakan rumus dibawah ini:
"flag = (msg1^x * msg2^y) mod pq".

2. Lalu untuk menangani eksponen negatif menggunakan Invers Modular:
"msg1^x ≡ (msg1^{-1})^{|x|} mod pq".


Berikut Script Solver untuk menyelesaikan tantangan ini:

        #Script Solver:
                #@WanZKey
		from Crypto.Util.number import long_to_bytes

		pq = 8936396806210526376141535339320387823150632232768025074585150591450030342206739518984596873580048532158059431947151704989934421112343371270553045654957003707832178597263987770629732733312586314686634975339561970271092488597023151433664491322133177095608320300299786978779169268542548863459526287208102109014561040941363941559454093027421535766246401867857307704897740625661125317008732659703903812825923671450283119589909627550816583337750263847443638256518882885826501709869226134948243652941257691269039832456963313242820268668152500562964805729573667818693090015710068568308108426351178618148559207653302567726453
		a = 32061
		b = 25772
		msg1 = 7695596237478159522452087218845013527373478230607104177524270309024459526033335750001151727866555570291892743979750985120897025450462055592528248478274362020113749559145555853098093830111817392492813273992088466078651780421143270914464677221287963762908081568342838834538516994647149568818015125152403393987410632675950398066466919926902308259336076973660543304070430193620256482213620575763644889245568141571033647659434287956659556787958083570354879801789295843963231617273422097444166050659303762035064451157393402922329616442321648473714835432708240321316535631852601475690117298226463949192488540950263855042907
		msg2 = 8726827715731958059539441667281144076307125863408191935133153896621344848666078224840971961017467059048081311754984352770649072429357806259980769502126194401035117039555235808191275684416100769313649444316736944064888595183348029100504658610051446845811200104635286154291344738727317791921960633499241096213543147633334898592946532632215854688749781744916767484573725857756576525177360420560009768973850301523326349630709430357510669786471900807220296373417053854263624880781501015930954863096318711799739788646820945229128120530409860911356841163797303328058004651862646657441084726421343809574301546431146458406010

		x, y = -7991, 9941

		inv_msg1 = pow(msg1, -1, pq)

		part1 = pow(inv_msg1, abs(x), pq)
		part2 = pow(msg2, y, pq)
		flag = (part1 * part2) % pq

		print(long_to_bytes(flag))


	# Output Script:
	┌──(wanz)─(wanzkey㉿Hengker-Bwang)-[~/Projec-TCP1P/Crypto/Es Coco Prime/solver]
	└─$ python3 solver.py
	b'RAMADAN{bel4jar_common_modulus_attack_m4ke_coprime_coy!!!_very_easy_ga_sii?}'

#Flag: RAMADAN{bel4jar_common_modulus_attack_m4ke_coprime_coy!!!_very_easy_ga_sii?}  
